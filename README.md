oss
===

Open Secret Server

OSS is a webapp which manages secrets (mainly AES wrapping keys) on behalf of applications which query the OSS at launch time to retrieve a master AES wrapping key with which all their sensitive data has been encrypted.

OSS itself has a master wrapping key with which it encrypts all the secrets it manages.

The OSS wrapping key is generated and encrypted with multiple PGP keys. Optionally, the wrapping key can be split using a Shamir Secret Sharing Scheme so that k splits amont n are needed to reconstruct the master wrapping key.

Calls to the OSS are authenticated using signatures generated by an SSH agent.

The dialogue with the SSH agent is established using the JUDS 0.94 library (see https://github.com/mcfunley/juds).
 
This wrapping key needs to be sent to the OSS upon startup.




Make sure your SSH agent is running and has private keys added to it.

Those private keys MUST have privileges in order to access OSSInit / OSSGenSecret / OSSGetSecret, see web.xml

1. GenMasterSecret

gpg -export -a > pubring
gradle -Doss.url=http://127.0.0.1:8080/oss -Doss.pubring=./pubring -Doss.keyid=XXXXXXXX,YYYYYYYY,ZZZZZZZZ -Doss.k=2 OSSGenMasterSecret

XXXXXXXX.oss
YYYYYYYY.oss
ZZZZZZZZ.oss

2. Init

gpg -d XXXXXXXX.oss | gradle -Doss.url=http://127.0.0.1:8080/oss OSSInit
gpg -d YYYYYYYY.oss | gradle -Doss.url=http://127.0.0.1:8080/oss OSSInit
... (depends on value of oss.k at step 1)

3. GenSecret

gradle -Doss.url=http://127.0.0.1:8080/oss -Doss.secret=SECRET_NAME OSSGenSecret

4. GetSecret

gradle -Doss.url=http://127.0.0.1:8080/oss -Doss.secret=SECRET_NAME OSSGetSecret
